# AMLS Assignment 25/26 - SN25129580

This project implements **two models** for the **BreastMNIST** dataset:

- **Task A (Classical ML):** feature preprocessing + a classical classifier(SVM) (see `A/model_a.py`)
- **Task B (Deep Learning):** a CNN trained with PyTorch (see `B/model_b.py`)

Run train and test from the project root with:

```bash
python main.py
```


## 1. Repository structure

```
AMLS_25_26_SN25129580/
├─ A/
│  └─ model_a.py          # Task A implementation (classical ML: SVM)
├─ B/
│  └─ model_b.py          # Task B implementation (deep learning)
├─ Datasets/              
│  └─ BreastMNIST/        
├─ Results/               # Outputs (e.g., training curves)
├─ experiment_results.txt # Sweep results (generated by test_sweep.py)
├─ main.py                # Entry point: runs Task A then Task B
├─ test_sweep.py          # Hyper-parameter sweep script
└─ README.md
```

---

## 2. What each file does

### `main.py`
- Locates the dataset root folder and passes it to both tasks.
- Runs the full pipeline:
  1) Train + validate **Task A**, then final test once
  2) Train + validate **Task B**, then final test once
- Prints validation metrics and a single final test report for each task.

### `A/model_a.py`
- Defines class **`TaskA`** with:
  - `train()` — trains the classical ML model
  - `validate()` — evaluates on the validation set
  - `test()` — evaluates on the test set

### `B/model_b.py`
- Defines class **`TaskB`** (and the CNN model) with:
  - `train()` — trains the neural network
  - `validate()` — evaluates on the validation set
  - `test()` — evaluates on the test set

### `test_sweep.py`
- Runs a small hyper-parameter sweep for both tasks.
- Uses validation metrics for comparison and does a single final test on the best setting.
- Writes results to `experiment_results.txt`.

---

## 3. Dependencies

Python 3.9+ recommended.

Install requirements:

```bash
pip install numpy scipy scikit-learn torch torchvision medmnist pillow matplotlib
```


---

## 4. Dataset placement (compatibility)

The code is intended to work with either of the following dataset locations:

- `Datasets/BreastMNIST/breastmnist.npz`
- `Datasets/breastmnist.npz`

In the marking environment, the dataset is expected to be copied into `Datasets/` by the assessors.

If you are running locally and want to download automatically via `medmnist`, you can create the folder first:

```bash
mkdir -p Datasets/BreastMNIST
```

Then run:

```bash
python main.py
```

You can also set a global random seed for reproducibility:

```bash
python main.py --seed 25129580
```

---

## 5. How to run

From the repository root:

```bash
python main.py
```

The console will show:
- Task A training and testing
- Task B training and testing
- Final test accuracy for both tasks

To test different parameters impacts:
```bash
python test_sweep.py
```

The code will test all the parameters of it and export the results as a txt file.
